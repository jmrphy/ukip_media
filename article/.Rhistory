?ts
x <- ts(diffvars$UKIP.Articles, deltat=1/12)
fit <- tbats(x)
seasonal <- !is.null(fit$seasonal)
!is.null(fit$seasonal)
View(diffvars)
?var
?VAR
x <- ts(diffvars$UKIP.Vote, deltat=1/12)
fit <- tbats(x)
!is.null(fit$seasonal)
var.season<-VAR(diffvars[2:3], lag.max=10, ic="AIC", type="both", season=12, exogen=diffvars[9:10])
summary(var.season)
causality(var.season, cause="UKIP.Vote")
causality(var.season, cause="UKIP.Articles")
causality(var.season, cause="UKIP.Articles", vcov.=vcovHC(varseason))
causality(var.season, cause="UKIP.Vote", vcov.=vcovHC(var.season))
causality(var.season, cause="UKIP.Articles", vcov.=vcovHC(var.season))
summary(var.season)
varmodel<-VAR(diffvars[2:3], lag.max=10, ic="AIC", type="both", exogen=diffvars[9:10])
causality(varmodel, cause="UKIP.Vote", vcov.=vcovHC(varmodel))
causality(varmodel, cause="UKIP.Articles", vcov.=vcovHC(varmodel))
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles"), main="Impulse Response from Vote")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles"), main="Impulse Response from UKIP.Vote")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote"), main="Impulse Response from UKIP.Vote")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles"), main="Impulse Response from Vote")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote"), main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles"), main="Impulse Response of Articles from Support")
?irf
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles"),
main="Impulse Response of Articles from Support", n.ahead=10)
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", n.ahead=1),
main="Impulse Response of Articles from Support")
?irf
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", n.ahead=5),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles"),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote"),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles"),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote"),
main="Impulse Response of Support from Articles")
causality(varmodel, cause="UKIP.Vote", vcov.=vcovHC(varmodel))
causality(varmodel, cause="UKIP.Articles", vcov.=vcovHC(varmodel))
?causality
causality(varmodel, cause="UKIP.Articles", vcov.=vcovHC(varmodel))
plot(irf(varmodel, response="UKIP.Articles"),
main="Impulse Response of Articles from Support")
summary(varmodel)
causality(varmodel, cause="UKIP.Articles")
causality(varmodel, cause="UKIP.Vote")
causality(varmodel, cause="UKIP.Articles", vcov.=vcovHC(varmodel))
causality(varmodel, cause="UKIP.Vote", vcov.=vcovHC(varmodel))
?irf
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE),
main="Impulse Response of Articles from Support")
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE),
main="Impulse Response of Articles from Support")
?irf
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE),
main="Impulse Response of Support from Articles")
set.seed(666)
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE),
main="Impulse Response of Articles from Support")
?irf
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE, boot=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE, boot=TRUE),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=F, boot=TRUE),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=F, boot=TRUE),
main="Impulse Response of Support from Articles")
?irf
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=F, boot=TRUE, ortho=TRUE),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=F, boot=TRUE, ortho=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE, boot=TRUE, ortho=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE, boot=TRUE, ortho=TRUE),
main="Impulse Response of Articles from Support")
fcst <- predict(varmodel, n.ahead = 8, ci = 0.95)
require(lubridate)
require(ggplot2)
require(timeSeries)
require(tseries)
require(reshape2)
require(scales)
require(vars)
require(car)
require(dynlm)
require(stargazer)
require(sandwich)
require(forecast)
#setwd("C:/Users/Daniel/Dropbox/ukip_media/article")
setwd("~/Dropbox/gh_projects/ukip_media/article")
df<-read.csv("~/Dropbox/gh_projects/ukip_media/data/ukip_media.csv")
df$Date<-mdy(df$Date)
df$UKIP.Vote<-interpNA(df$UKIP.Vote, method = "linear")
unscaled<-df
modelvars<-df[c("Date", "UKIP.Vote", "UKIP.Articles", "General.Election2005", "General.Election2010",
"Euro.Election2004","Euro.Election2009", "Euro.Election2014")]
cbbPalette <- c("#D55E00", "#0072B2","#009E73","#999999", "#56B4E9","#CC79A7")
ggplot(df, aes(x=Date, y=UKIP.Vote)) +
geom_line(colour="#0072B2") + theme_bw() + labs(y="Vote Intention (%)", x="") +
theme(axis.text.y = element_text(size=12.45)) +
labs(title="Dynamics of UKIP Support and Media Coverage")
ggplot(df, aes(x=Date, y=UKIP.Articles)) +
geom_line(colour="#D55E00") + theme_bw() + labs(y="Articles", x="") +
theme(axis.text.y = element_text(size=7.25))
df$UKIP.Articles<-scale(df$UKIP.Articles)[,]
df$UKIP.Vote<-scale(df$UKIP.Vote)[,]
# Both series in one plot
graph.df<-subset(df, select=c("Date", "UKIP.Articles", "UKIP.Vote"))
molten<-melt(graph.df, id.vars=c("Date"))
ggplot(molten, aes(x=as.Date(Date))) +
geom_line(aes(y=value, colour=variable)) +
scale_colour_manual(values=cbbPalette) +
scale_x_date(labels = date_format("%m/%Y"),
breaks = "6 months",
limits = as.Date(c('2004-02-01','2015-03-01'))) +
theme_bw() +
theme(legend.position="bottom",
legend.title=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(axis.text.y = element_text(size=12.45)) +
labs(x="Date", y="Standardized Values") +
theme(legend.position="none")
modelvars$UKIP.Articles<-log(modelvars$UKIP.Articles)
modelvars$UKIP.Vote<-log(modelvars$UKIP.Vote)
# modelvars$UKIP.Articles<-scale(modelvars$UKIP.Articles)
# modelvars$UKIP.Vote<-scale(modelvars$UKIP.Vote)
diffvars<-data.frame()  # difference variables and lag dates/elections to match
diffvars<-as.data.frame(cbind(modelvars$Date[2:length(modelvars$Date)],
diff(modelvars$UKIP.Vote),
diff(modelvars$UKIP.Articles),
modelvars[2:length(modelvars$Date), 4:8]))
names(diffvars)<-c("Date", "UKIP.Vote", "UKIP.Articles", "General.Election2005", "General.Election2010",
"Euro.Election2004","Euro.Election2009", "Euro.Election2014")
row.names(diffvars)<-NULL
diffvars$General.Elections<-ifelse(diffvars$General.Election2005==1 | diffvars$General.Election2010==1, 1, 0)
diffvars$EU.Elections<-ifelse(diffvars$Euro.Election2004==1 |
diffvars$Euro.Election2009==1 |
diffvars$Euro.Election2014==1,
1, 0)
VARselect(diffvars[2:3], type="both", season=12, exogen=diffvars[9:10])
varmodel<-VAR(diffvars[2:3], lag.max=10, ic="AIC", type="both", exogen=diffvars[9:10])
serial.test(varmodel)
arch.test(varmodel)
stab<-stability(varmodel)
plot(stab)
summary(varmodel, equation="UKIP.Articles")
summary(varmodel, equation="UKIP.Vote")
?causality
causality(varmodel, cause="UKIP.Vote")
causality(varmodel, cause="UKIP.Articles")
causality(varmodel, cause="UKIP.Articles")
causality(varmodel, cause="UKIP.Vote", vcov.=vcovHC(varmodel))
causality(varmodel, cause="UKIP.Articles", vcov.=vcovHC(varmodel))
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE, boot=TRUE, ortho=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE, boot=TRUE, ortho=TRUE),
main="Impulse Response of Articles from Support")
var.season<-VAR(diffvars[2:3], lag.max=10, ic="AIC", type="both", season=12, exogen=diffvars[9:10])
var.season<-VAR(diffvars[2:3], lag.max=10, ic="AIC", type="both", season=12, exogen=diffvars[9:10])
# causality(var.season, cause="UKIP.Vote", vcov.=vcovHC(var.season))
# causality(var.season, cause="UKIP.Articles", vcov.=vcovHC(var.season))
causality(var.season, cause="UKIP.Vote", vcov.=vcovHC(var.season))
causality(var.season, cause="UKIP.Articles", vcov.=vcovHC(var.season))
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE, boot=TRUE, ortho=TRUE),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE, boot=TRUE, ortho=TRUE),
main="Impulse Response of Support from Articles")
fcst <- predict(varmodel, n.ahead = 8, ci = 0.95)
View(modelvars)
View(diffvars)
View(modelvars)
require(lubridate)
require(ggplot2)
require(timeSeries)
require(tseries)
require(reshape2)
require(scales)
require(vars)
require(car)
require(dynlm)
require(stargazer)
require(sandwich)
require(forecast)
#setwd("C:/Users/Daniel/Dropbox/ukip_media/article")
setwd("~/Dropbox/gh_projects/ukip_media/article")
df<-read.csv("~/Dropbox/gh_projects/ukip_media/data/ukip_media.csv")
df$Date<-mdy(df$Date)
df$UKIP.Vote<-interpNA(df$UKIP.Vote, method = "linear")
unscaled<-df
modelvars<-df[c("Date", "UKIP.Vote", "UKIP.Articles", "General.Election2005", "General.Election2010",
"Euro.Election2004","Euro.Election2009", "Euro.Election2014")]
cbbPalette <- c("#D55E00", "#0072B2","#009E73","#999999", "#56B4E9","#CC79A7")
ggplot(df, aes(x=Date, y=UKIP.Vote)) +
geom_line(colour="#0072B2") + theme_bw() + labs(y="Vote Intention (%)", x="") +
theme(axis.text.y = element_text(size=12.45)) +
labs(title="Dynamics of UKIP Support and Media Coverage")
ggplot(df, aes(x=Date, y=UKIP.Articles)) +
geom_line(colour="#D55E00") + theme_bw() + labs(y="Articles", x="") +
theme(axis.text.y = element_text(size=7.25))
df$UKIP.Articles<-scale(df$UKIP.Articles)[,]
df$UKIP.Vote<-scale(df$UKIP.Vote)[,]
# Both series in one plot
graph.df<-subset(df, select=c("Date", "UKIP.Articles", "UKIP.Vote"))
molten<-melt(graph.df, id.vars=c("Date"))
ggplot(molten, aes(x=as.Date(Date))) +
geom_line(aes(y=value, colour=variable)) +
scale_colour_manual(values=cbbPalette) +
scale_x_date(labels = date_format("%m/%Y"),
breaks = "6 months",
limits = as.Date(c('2004-02-01','2015-03-01'))) +
theme_bw() +
theme(legend.position="bottom",
legend.title=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(axis.text.y = element_text(size=12.45)) +
labs(x="Date", y="Standardized Values") +
theme(legend.position="none")
modelvars$UKIP.Articles<-log(modelvars$UKIP.Articles)
modelvars$UKIP.Vote<-log(modelvars$UKIP.Vote)
modelvars$General.Elections<-ifelse(modelvars$General.Election2005==1 | modelvars$General.Election2010==1, 1, 0)
modelvars$EU.Elections<-ifelse(modelvars$Euro.Election2004==1 |
modelvars$Euro.Election2009==1 |
modelvars$Euro.Election2014==1,
1, 0)
View(modelvars)
diffvars<-data.frame()  # difference variables and lag dates/elections to match
diffvars<-as.data.frame(cbind(modelvars$Date[2:length(modelvars$Date)],
diff(modelvars$UKIP.Vote),
diff(modelvars$UKIP.Articles),
modelvars[2:length(modelvars$Date), 4:10]))
names(diffvars)<-c("Date", "UKIP.Vote", "UKIP.Articles", "General.Election2005", "General.Election2010",
"Euro.Election2004","Euro.Election2009", "Euro.Election2014",
"General.Elections", "EU.Elections")
View(diffvars)
row.names(diffvars)<-NULL
View(diffvars)
varmodel<-VAR(diffvars[2:3], lag.max=10, ic="AIC", type="both", exogen=diffvars[9:10])
causality(var.season, cause="UKIP.Articles", vcov.=vcovHC(var.season))
varmodel<-VAR(diffvars[2:3], lag.max=10, ic="AIC", type="both", exogen=diffvars[9:10])
causality(varmodel, cause="UKIP.Articles", vcov.=vcovHC(varmodel))
View(modelvars)
modelvars<-as.ts(modelvars)
ecm.articles<-dynlm(d(UKIP.Articles) ~
lag(UKIP.Articles, -1) +
lag(UKIP.Vote,1,lag=1) +
diff(UKIP.Vote,1,lag=1) +
trend(UKIP.Articles) +
General.Elections +
EU.Elections,
data=modelvars)
summary(ecm.articles)
?lag
?diff
ecm.articles<-dynlm(d(UKIP.Articles) ~
lag(UKIP.Articles, k=1) +
lag(UKIP.Vote,k=1) +
diff(UKIP.Vote,diff=1, lag=1) +
trend(UKIP.Articles) +
General.Elections +
EU.Elections,
data=modelvars)
summary(ecm.articles)
?lag
ecm.articles<-dynlm(d(UKIP.Articles) ~
lag(UKIP.Articles, k=1) +
lag(UKIP.Vote,k=1) +
diff(UKIP.Vote,diff=1, lag=1) +
trend(UKIP.Articles) +
General.Elections +
EU.Elections,
data=modelvars)
summary(ecm.articles)
ecm.vote<-dynlm(d(UKIP.Vote) ~
lag(UKIP.Vote, -1) +
lag(UKIP.Articles, 1, lag=1) +
diff(UKIP.Articles, 1, lag=1) +
trend(UKIP.Vote),
data=modelvars)
summary(ecm.vote)
ecm.vote<-dynlm(d(UKIP.Vote) ~
lag(UKIP.Vote, -1) +
lag(UKIP.Articles, 1, lag=1) +
diff(UKIP.Articles, 1, lag=1) +
trend(UKIP.Vote) +
General.Elections +
EU.Elections,
data=modelvars)
summary(ecm.vote)
ecm.vote<-dynlm(d(UKIP.Vote) ~
lag(UKIP.Vote, k=1) +
lag(UKIP.Articles, k=1) +
diff(UKIP.Articles, diff=1, lag=1) +
trend(UKIP.Vote) +
General.Elections +
EU.Elections,
data=modelvars)
summary(ecm.vote)
?lag
?d
?diff
ecm.vote<-dynlm(diff(UKIP.Vote) ~
lag(UKIP.Vote, k=1) +
lag(UKIP.Articles, k=1) +
diff(UKIP.Articles, diff=1, lag=1) +
trend(UKIP.Vote) +
General.Elections +
EU.Elections,
data=modelvars)
summary(ecm.vote)
ecm.articles<-dynlm(diff(UKIP.Articles) ~
lag(UKIP.Articles, k=1) +
lag(UKIP.Vote,k=1) +
diff(UKIP.Vote,diff=1, lag=1) +
trend(UKIP.Articles) +
General.Elections +
EU.Elections,
data=modelvars)
summary(ecm.articles)
ecm.articles<-dynlm(diff(UKIP.Articles) ~
lag(UKIP.Articles, k=1) +
lag(UKIP.Articles, k=2) +
lag(UKIP.Articles, k=3) +
lag(UKIP.Vote,k=1) +
diff(UKIP.Vote,diff=1, lag=1) +
trend(UKIP.Articles) +
General.Elections +
EU.Elections,
data=modelvars)
summary(ecm.articles)
setwd("~/Dropbox/gh_projects/ukip_media/article")
df<-read.csv("~/Dropbox/gh_projects/ukip_media/data/ukip_media.csv")
df$Date<-mdy(df$Date)
df$UKIP.Vote<-interpNA(df$UKIP.Vote, method = "linear")
unscaled<-df
View(df)
modelvars<-df[c("Date", "UKIP.Vote", "UKIP.Articles", "General.Election2005", "General.Election2010",
"General.Election2015", "Euro.Election2004","Euro.Election2009", "Euro.Election2014")]
cbbPalette <- c("#D55E00", "#0072B2","#009E73","#999999", "#56B4E9","#CC79A7")
ggplot(df, aes(x=Date, y=UKIP.Vote)) +
geom_line(colour="#0072B2") + theme_bw() + labs(y="Vote Intention (%)", x="") +
theme(axis.text.y = element_text(size=12.45)) +
labs(title="Dynamics of UKIP Support and Media Coverage")
ggplot(df, aes(x=Date, y=UKIP.Articles)) +
geom_line(colour="#D55E00") + theme_bw() + labs(y="Articles", x="") +
theme(axis.text.y = element_text(size=7.25))
df$UKIP.Articles<-scale(df$UKIP.Articles)[,]
df$UKIP.Vote<-scale(df$UKIP.Vote)[,]
# Both series in one plot
graph.df<-subset(df, select=c("Date", "UKIP.Articles", "UKIP.Vote"))
molten<-melt(graph.df, id.vars=c("Date"))
ggplot(molten, aes(x=as.Date(Date))) +
geom_line(aes(y=value, colour=variable)) +
scale_colour_manual(values=cbbPalette) +
scale_x_date(labels = date_format("%m/%Y"),
breaks = "6 months",
limits = as.Date(c('2004-02-01','2015-03-01'))) +
theme_bw() +
theme(legend.position="bottom",
legend.title=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(axis.text.y = element_text(size=12.45)) +
labs(x="Date", y="Standardized Values") +
theme(legend.position="none")
modelvars$UKIP.Articles<-log(modelvars$UKIP.Articles)
modelvars$UKIP.Vote<-log(modelvars$UKIP.Vote)
modelvars$General.Elections<-ifelse(modelvars$General.Election2005==1 | modelvars$General.Election2010==1, 1, 0)
modelvars$EU.Elections<-ifelse(modelvars$Euro.Election2004==1 |
modelvars$Euro.Election2009==1 |
modelvars$Euro.Election2014==1,
1, 0)
modelvars$General.Elections<-ifelse(modelvars$General.Election2005==1 | modelvars$General.Election2010==1 |
modelvars$General.Election2015==1, 1, 0)
modelvars$EU.Elections<-ifelse(modelvars$Euro.Election2004==1 |
modelvars$Euro.Election2009==1 |
modelvars$Euro.Election2014==1,
1, 0)
View(modelvars)
View(modelvars)
View(modelvars)
diffvars<-data.frame()  # difference variables and lag dates/elections to match
diffvars<-as.data.frame(cbind(modelvars$Date[2:length(modelvars$Date)],
diff(modelvars$UKIP.Vote),
diff(modelvars$UKIP.Articles),
modelvars[2:length(modelvars$Date), 4:11]))
View(diffvars)
View(diffvars)
names(diffvars)<-c("Date", "UKIP.Vote", "UKIP.Articles", "General.Election2005", "General.Election2010",
"General.Election2015", "Euro.Election2004","Euro.Election2009", "Euro.Election2014",
"General.Elections", "EU.Elections")
row.names(diffvars)<-NULL
x <- ts(diffvars$UKIP.Articles, deltat=1/12)
fit <- tbats(x)
!is.null(fit$seasonal) # is seasonal
View(diffvars)
varmodel<-VAR(diffvars[2:3], lag.max=10, ic="AIC", type="both", exogen=diffvars[10:11])
serial.test(varmodel)
arch.test(varmodel)
summary(varmodel, equation="UKIP.Articles")
summary(varmodel, equation="UKIP.Vote")
set.seed(666)
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE, boot=TRUE, ortho=TRUE),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE, boot=TRUE, ortho=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=F, boot=TRUE, ortho=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=F, boot=TRUE, ortho=TRUE),
main="Impulse Response of Articles from Support")
causality(var.season, cause="UKIP.Vote", vcov.=vcovHC(var.season))
causality(varmodel, cause="UKIP.Vote", vcov.=vcovHC(varmodel))
causality(varmodel, cause="UKIP.Articles", vcov.=vcovHC(varmodel))
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles"),
main="Impulse Response of Articles from Support")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote"),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Articles", response="UKIP.Vote", cumulative=TRUE),
main="Impulse Response of Support from Articles")
plot(irf(varmodel, impulse="UKIP.Vote", response="UKIP.Articles", cumulative=TRUE),
main="Impulse Response of Articles from Support")
setwd("~/Dropbox/gh_projects/ukip_media/article")
df<-read.csv("~/Dropbox/gh_projects/ukip_media/data/ukip_media.csv")
df$Date<-mdy(df$Date)
df$UKIP.Vote<-interpNA(df$UKIP.Vote, method = "linear")
unscaled<-df
modelvars<-df[c("Date", "UKIP.Vote", "UKIP.Articles", "General.Election2005", "General.Election2010",
"General.Election2015", "Euro.Election2004","Euro.Election2009", "Euro.Election2014")]
cbbPalette <- c("#D55E00", "#0072B2","#009E73","#999999", "#56B4E9","#CC79A7")
ggplot(df, aes(x=Date, y=UKIP.Vote)) +
geom_line(colour="#0072B2") + theme_bw() + labs(y="Vote Intention (%)", x="") +
theme(axis.text.y = element_text(size=12.45)) +
labs(title="Dynamics of UKIP Support and Media Coverage")
ggplot(df, aes(x=Date, y=UKIP.Articles)) +
geom_line(colour="#D55E00") + theme_bw() + labs(y="Articles", x="") +
theme(axis.text.y = element_text(size=7.25))
df$UKIP.Articles<-scale(df$UKIP.Articles)[,]
df$UKIP.Vote<-scale(df$UKIP.Vote)[,]
# Both series in one plot
graph.df<-subset(df, select=c("Date", "UKIP.Articles", "UKIP.Vote"))
molten<-melt(graph.df, id.vars=c("Date"))
ggplot(molten, aes(x=as.Date(Date))) +
geom_line(aes(y=value, colour=variable)) +
scale_colour_manual(values=cbbPalette) +
scale_x_date(labels = date_format("%m/%Y"),
breaks = "6 months",
limits = as.Date(c('2004-02-01','2015-03-01'))) +
theme_bw() +
theme(legend.position="bottom",
legend.title=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(axis.text.y = element_text(size=12.45)) +
labs(x="Date", y="Standardized Values") +
theme(legend.position="none")
modelvars$General.Elections<-ifelse(modelvars$General.Election2005==1 | modelvars$General.Election2010==1 |
modelvars$General.Election2015==1, 1, 0)
modelvars$EU.Elections<-ifelse(modelvars$Euro.Election2004==1 |
modelvars$Euro.Election2009==1 |
modelvars$Euro.Election2014==1,
1, 0)
modelvars$UKIP.Articles<-scale(modelvars$UKIP.Articles)
View(modelvars)
View(modelvars)
modelvars$UKIP.Vote<-scale(modelvars$UKIP.Vote)
diffvars<-data.frame()  # difference variables and lag dates/elections to match
diffvars<-as.data.frame(cbind(modelvars$Date[2:length(modelvars$Date)],
diff(modelvars$UKIP.Vote),
diff(modelvars$UKIP.Articles),
modelvars[2:length(modelvars$Date), 4:11]))
names(diffvars)<-c("Date", "UKIP.Vote", "UKIP.Articles", "General.Election2005", "General.Election2010",
"General.Election2015", "Euro.Election2004","Euro.Election2009", "Euro.Election2014",
"General.Elections", "EU.Elections")
row.names(diffvars)<-NULL
x <- ts(diffvars$UKIP.Articles, deltat=1/12)
fit <- tbats(x)
!is.null(fit$seasonal) # is seasonal
x <- ts(diffvars$UKIP.Vote, deltat=1/12)
fit <- tbats(x)
!is.null(fit$seasonal) # is seasonal
varmodel<-VAR(diffvars[2:3], lag.max=10, ic="AIC", type="both", exogen=diffvars[10:11])
serial.test(varmodel)
arch.test(varmodel)
stab<-stability(varmodel)
plot(stab)
causality(varmodel, cause="UKIP.Vote", vcov.=vcovHC(varmodel))
causality(varmodel, cause="UKIP.Articles", vcov.=vcovHC(varmodel))
